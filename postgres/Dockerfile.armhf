FROM armhf/alpine:3.4

ENV LANG en_US.utf8
ENV PGDATA /var/lib/postgresql/data

RUN apk add -U --no-cache postgresql bash su-exec ca-certificates curl \
    && curl -sSL -o /docker-entrypoint.sh "https://raw.githubusercontent.com/docker-library/postgres/master/9.5/alpine/docker-entrypoint.sh" \
    && curl -sSL -o /usr/local/bin/gosu "https://github.com/tianon/gosu/releases/download/1.7/gosu-armhf" \
    && apk del --purge -r ca-certificates curl \
    && chmod +x /usr/local/bin/gosu \
    && mkdir -p /docker-entrypoint-initdb.d /run/postgresql \
    && chmod a+x /docker-entrypoint.sh

EXPOSE 5432
ENTRYPOINT [ "/docker-entrypoint.sh" ]
CMD [ "postgres", "-c", "listen_addresses=0.0.0.0" ]
